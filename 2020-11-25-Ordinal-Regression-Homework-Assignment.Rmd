---
title: "Homework Assignment"
author: "<strong>Gradient Metrics</strong>" #
date: '<i>`r format(Sys.Date(), "%B %d, %Y")`</i>'
output: 
  html_document


# Keep the <a> header tag. This makes sure there is a button to go back up. 
# Keep the <img> tag. This adds our logo to the document.
---

```{r, warning=FALSE, message=FALSE, echo=FALSE}
library(knitr)
opts_chunk$set(
	comment = "",
	#fig.width = 12, 
	message = FALSE,
	warning = FALSE,
	tidy.opts = list(
		keep.blank.line = TRUE,
		width.cutoff = 150
		),
	options(width = 150),
	eval = TRUE,
	echo = TRUE,
	fig.height =8,
	fig.width = 6,
	fig.align = "left"
)
# print head
# don't print long-lines
```

# Introduction

Welcome! We are happy to proceed the hiring process with a homework assignment.
In this exercise we would like you to get into the shoes of a market research analyst.

We will be evaluating your analytical skills and your ability to defend the approach you used and how you explain your results. We will be paying special attention to the quality of your code. 

This exercise examines both your skills of managing an R project and evaluating a data analysis task.

- Please structure your code as an R package, with proper documentation, examples and tests. 
- Please put the data in your package as a dataset.
- The final analysis should be wrapped into a vignette that is distributed with the package. 
- We would love to see your package being hosted on GitHub. 
  + A nice to have is a setup of GitHub Actions that verifies the proper build of the package.

```{r, warning=FALSE, message=FALSE}
library(haven);library(dplyr);library(purrr)
```

# Assignment Context

One of our clients asked us to develop the best possible message for the product they offer. We developed a survey experiment that would display a random combination of phrases along with a price and the length of a subscription. Each respondent saw 12 random permutations of the message. For each permutation, the respondent was asked to rate `"How likely are you to download this mobile app?"`. The app we are referring to in this case was an app to help people sleep better. 

Your goal now is to advice on the best combination of attributes displayed in the message. Each **attribute** (e.g. `price`) has multiple **levels** that, as explained, vary for each task. 

![](images/experiment.JPG)

Alongside the experiment, we conducted a regular survey with a set of questions related to sleep and socio-demographic behavior. Thanks to the survey we were able to describe a group of highly likely downloaders so that our client was able to understand the potential audience in the market.

# Your tasks

1. Find out how each attribute (and level) influences the overall likeliness to download (`experiment_data$answer`).
1. Describe the groups of respondents that we see in the data using the added demographic, psychological and behavioral data.  Feel free to experiment with clustering techniques in addition to descriptives. 

You are free to use any method that you think is reasonable for this challenge. 

> Hint: The message testing experiment is a ratings-based conjoint on an ordinal scale. 

# Data

See an overview and an explanation of the datasets below. 

## Experiment Data

```{r}
experiment_data <-
  read_sav('data/experiment_data.sav')

head(experiment_data)
```

Answers translate into the level with the below dictionary

- 1 - Very unlikely 
- 2 - Somewhat unlikely 
- 3 - Somewhat likely 
- 4 - Very likely


### Attribute map

There were 6 attributes considered in the message testing at the experiment.
Below you can see which attributes had what possible levels.

```{r}
experiment_data %>%
  select(duration:social_proof) %>%
  map(unique) %>% 
  map(~t(t(.x)))
```

## Survey data

```{r}
survey_data <-
  read_sav('data/survey_data.sav')
```


### Demographic battery

```{r} 
survey_demo <-
  survey_data %>%
  select(response_id, d_urban:s_problem, d_marital:weights)
```

### Philosophy Module

This module aimed to verify **Personal philosophy on Science, Products and Health**

![](images/m1.JPG)

```{r}
survey_philosophy <-
  survey_data %>%
  select(response_id, contains('m1_philosophy'))
```

### Awareness Module

This module aimed to check **Attitudes & Awareness** towards statements related to sleep.

![](images/m2.JPG)

```{r}
survey_awareness <-
  survey_data %>%
    select(response_id, contains('m2_awareness'))
```

### Source & Solutions Module

This module asked about **sources of trouble with sleeping** at night and any **actions taken to improve the quality of sleep**.

### Source question

> Thinking about the past year, what are the primary reasons you have trouble sleeping at night? Select up to three. 

![](images/source.JPG)

```{r}
survey_source <-
  survey_data %>%
    select(response_id, contains('source'))
```

### Behavioral questions

![](images/behavior.JPG)

```{r}
survey_behavior <-
  survey_data %>%
    select(response_id, contains('behavior'))
```


### Other questions related to source and solutions

![](images/other.JPG)

```{r}
survey_behavior <-
  survey_data %>%
    select(response_id, interst_cbt:interest_coach)
```

